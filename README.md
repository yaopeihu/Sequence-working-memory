Refer to Science article:

**Xie, Hu et al. Geometry of Sequence Working Memory in Macaque Prefrontal Cortex. 2022**

Data used in the code is available at [Zenodo](https://doi.org/10.5281/zenodo.5739376)

Contact Xie for questions related to state space analysis and Hu for others.

## Calcium image processing

Based on [CAIMAN](https://github.com/flatironinstitute/CaImAn)

Preprocess-demo: select stable data from continuous recording on a trial-by-trial basis

Pipeline-demo: a semi-automated source extraction pipeline using CNMF


## Decoding analysis

Decoding item information using a two-layer neural network

decode-items: parallel training for leave-one-trial/sequence-out decoding

decoding1: analyze the leave-one-trial-out decoding result

decoding2: training decoder for cross-length and error trial decoding


## State space analysis

Multi-variable linear regression model for late delay activity.

Please add all files in this folder and its subfolder into path before run the 'main.m'.

The variable foldername in the main.m file should be adjusted to fit user's local path. 



